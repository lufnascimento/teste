------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- QUERYS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
vRP._prepare("bm_module/registration/getSocial", "SELECT user_id FROM bm_registration WHERE user_id = @user_id")
vRP._prepare("bm_module/registration/saveSocial", "INSERT IGNORE INTO bm_registration (user_id, nome, email, telefone, nascimento, sexo, social) VALUES(@user_id, @nome, @email, @telefone, @nascimento, @sexo, @social)")
vRP._prepare("bm_module/registration/createDB", "CREATE TABLE IF NOT EXISTS `bm_registration` ( `user_id` int(11) DEFAULT NULL, `nome` varchar(100) DEFAULT NULL, `email` varchar(50) DEFAULT NULL, `telefone` varchar(50) DEFAULT NULL, `nascimento` varchar(50) DEFAULT NULL, `sexo` varchar(50) DEFAULT NULL, `social` varchar(50) DEFAULT NULL, KEY `user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=latin1;")

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- FUNCTIONS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
saveSocial = function(user_id, nome, email, telefone, nascimento, sexo, social)
    vRP._execute("bm_module/registration/saveSocial", { user_id = user_id, nome = nome, email = email, telefone = telefone, nascimento = nascimento, sexo = sexo, social = social })
end

function RegisterTunnel.saveSocial(info)
    local source = source
    local user_id = vRP.getUserId(source)
    if user_id then
        if info then
            saveSocial(user_id, info.nome, info.email, info.telefone, info.nascimento, info.sexo, info.social)
            
            if config.registration.rewards[info.social] then
                config.registration.rewards[info.social](user_id, source)
            end
        end
    end
end

function checkOpenSocial(user_id)
    if user_id then
        local query = vRP.query("bm_module/registration/getSocial", { user_id = user_id })
        if #query == 0 then
            return true
        end

        return false
    end
end
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- COMANDOS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
RegisterCommand('social', function(source)
    -- EM BREVE
end)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- THREADS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CreateThread(function()
    vRP._execute("bm_module/registration/createDB", {})
end)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-- EXPORTS
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
exports("openSocial", checkOpenSocial)
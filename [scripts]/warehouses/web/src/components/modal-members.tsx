import { useCallback } from "react";
import fetch from "../utils/fetch";

interface ModalMembersProps {
  property: number | string;
  onClose: () => any;
  max_members: number;
  members: {
    name: string;
    uid: number;
  }[];
}

const colors = [
  '#FF5C5C',
  '#6BA6C8',
  '#62B26A'
]

export function ModalMembers({ property, max_members, members, onClose }: ModalMembersProps) {
  return (
    <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-neutral-500 rounded-xl border border-white/15 p-5 flex flex-col gap-3 w-[25rem] h-[26.125rem]">
      <div className="w-full flex items-center gap-2.5">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="16" cy="16" r="16" fill="white" fill-opacity="0.04" />
          <path d="M15.3274 17.8701C15.9976 17.4239 16.5063 16.774 16.7785 16.0163C17.0507 15.2587 17.0718 14.4336 16.8387 13.663C16.6057 12.8924 16.1309 12.2173 15.4844 11.7374C14.838 11.2576 14.0543 10.9985 13.2493 10.9985C12.4443 10.9985 11.6606 11.2576 11.0142 11.7374C10.3677 12.2173 9.8929 12.8924 9.65986 13.663C9.42681 14.4336 9.44794 15.2587 9.72011 16.0163C9.99228 16.774 10.501 17.4239 11.1712 17.8701C9.95898 18.3168 8.92374 19.1436 8.21992 20.2269C8.18293 20.2819 8.15724 20.3437 8.14434 20.4087C8.13143 20.4737 8.13158 20.5406 8.14476 20.6055C8.15795 20.6705 8.18391 20.7321 8.22113 20.787C8.25836 20.8418 8.30611 20.8886 8.36161 20.9248C8.41711 20.961 8.47926 20.9858 8.54443 20.9978C8.6096 21.0098 8.6765 21.0087 8.74125 20.9946C8.80599 20.9805 8.86728 20.9536 8.92156 20.9156C8.97584 20.8776 9.02202 20.8292 9.05742 20.7732C9.51142 20.0749 10.1326 19.5011 10.8647 19.1039C11.5967 18.7067 12.4164 18.4987 13.2493 18.4987C14.0822 18.4987 14.9019 18.7067 15.6339 19.1039C16.366 19.5011 16.9872 20.0749 17.4412 20.7732C17.5145 20.8822 17.6278 20.9579 17.7565 20.9841C17.8853 21.0102 18.0191 20.9846 18.1292 20.9129C18.2392 20.8411 18.3166 20.7289 18.3445 20.6005C18.3725 20.4722 18.3489 20.338 18.2787 20.2269C17.5749 19.1436 16.5396 18.3168 15.3274 17.8701ZM10.4993 14.7501C10.4993 14.2062 10.6606 13.6745 10.9628 13.2222C11.2649 12.77 11.6944 12.4175 12.1969 12.2094C12.6994 12.0012 13.2523 11.9468 13.7858 12.0529C14.3192 12.159 14.8092 12.4209 15.1938 12.8055C15.5784 13.1901 15.8403 13.6801 15.9465 14.2136C16.0526 14.747 15.9981 15.2999 15.79 15.8024C15.5818 16.3049 15.2294 16.7344 14.7771 17.0366C14.3249 17.3388 13.7932 17.5001 13.2493 17.5001C12.5202 17.4992 11.8212 17.2092 11.3057 16.6937C10.7901 16.1781 10.5001 15.4791 10.4993 14.7501ZM23.633 20.9188C23.522 20.9912 23.3867 21.0166 23.257 20.9893C23.1272 20.962 23.0136 20.8842 22.9412 20.7732C22.4877 20.0745 21.8666 19.5005 21.1344 19.1034C20.4022 18.7064 19.5822 18.4989 18.7493 18.5001C18.6167 18.5001 18.4895 18.4474 18.3957 18.3536C18.302 18.2598 18.2493 18.1327 18.2493 18.0001C18.2493 17.8674 18.302 17.7403 18.3957 17.6465C18.4895 17.5527 18.6167 17.5001 18.7493 17.5001C19.1543 17.4997 19.5542 17.4099 19.9204 17.237C20.2867 17.0642 20.6102 16.8126 20.8679 16.5002C21.1257 16.1878 21.3112 15.8223 21.4113 15.4299C21.5115 15.0375 21.5237 14.6278 21.4471 14.2301C21.3705 13.8325 21.2071 13.4566 20.9684 13.1294C20.7298 12.8022 20.4218 12.5318 20.0665 12.3375C19.7112 12.1431 19.3174 12.0296 18.9131 12.0051C18.5089 11.9806 18.1042 12.0457 17.728 12.1957C17.6667 12.2222 17.6007 12.2361 17.5339 12.2367C17.4671 12.2373 17.4008 12.2244 17.339 12.199C17.2773 12.1735 17.2212 12.1359 17.1742 12.0884C17.1272 12.0409 17.0902 11.9845 17.0654 11.9224C17.0406 11.8604 17.0285 11.794 17.0297 11.7272C17.031 11.6604 17.0457 11.5945 17.0728 11.5335C17.1 11.4724 17.1391 11.4174 17.1879 11.3718C17.2367 11.3261 17.2941 11.2907 17.3568 11.2676C18.2177 10.9242 19.1753 10.9119 20.0448 11.2329C20.9142 11.5539 21.634 12.1855 22.0653 13.0059C22.4966 13.8264 22.6087 14.7774 22.3801 15.6756C22.1515 16.5739 21.5984 17.3556 20.8274 17.8701C22.0396 18.3168 23.0749 19.1436 23.7787 20.2269C23.8511 20.338 23.8764 20.4733 23.8491 20.603C23.8218 20.7328 23.7441 20.8464 23.633 20.9188Z" fill="white" />
        </svg>

        <span className="text-white font-medium flex-1">Amigos <span className="text-white/45">({members.length}/{max_members})</span></span>
        <svg onClick={onClose} width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19.281 18.2193C19.3507 18.289 19.406 18.3717 19.4437 18.4628C19.4814 18.5538 19.5008 18.6514 19.5008 18.7499C19.5008 18.8485 19.4814 18.9461 19.4437 19.0371C19.406 19.1281 19.3507 19.2109 19.281 19.2806C19.2114 19.3502 19.1286 19.4055 19.0376 19.4432C18.9465 19.4809 18.849 19.5003 18.7504 19.5003C18.6519 19.5003 18.5543 19.4809 18.4632 19.4432C18.3722 19.4055 18.2895 19.3502 18.2198 19.2806L12.0004 13.0602L5.78104 19.2806C5.64031 19.4213 5.44944 19.5003 5.25042 19.5003C5.05139 19.5003 4.86052 19.4213 4.71979 19.2806C4.57906 19.1398 4.5 18.949 4.5 18.7499C4.5 18.5509 4.57906 18.36 4.71979 18.2193L10.9401 11.9999L4.71979 5.78055C4.57906 5.63982 4.5 5.44895 4.5 5.24993C4.5 5.05091 4.57906 4.86003 4.71979 4.7193C4.86052 4.57857 5.05139 4.49951 5.25042 4.49951C5.44944 4.49951 5.64031 4.57857 5.78104 4.7193L12.0004 10.9396L18.2198 4.7193C18.3605 4.57857 18.5514 4.49951 18.7504 4.49951C18.9494 4.49951 19.1403 4.57857 19.281 4.7193C19.4218 4.86003 19.5008 5.05091 19.5008 5.24993C19.5008 5.44895 19.4218 5.63982 19.281 5.78055L13.0607 11.9999L19.281 18.2193Z" fill="white" fill-opacity="0.15" />
        </svg>

      </div>
      <span className="text-white/45 text-sm">Amigos adicionados</span>
      <div className="flex flex-col gap-2 w-full flex-1 overflow-auto">
        {members.map(member => (
          <div className="w-full bg-white/[0.03] p-2 rounded-[5px] flex items-center gap-2.5">
            <div className="w-[1.625rem] h-[1.625rem] rounded-full grid place-items-center text-white" style={{ backgroundColor: colors[Math.floor(Math.random() * colors.length)] }}>{member.name[0].toUpperCase()}</div>
            <span className="text-white text-base flex-1">{member.name} <span className="text-white/45">({member.uid})</span></span>
            <svg onClick={() => fetch('REMOVE_MEMBER_PROPERTY', { property_id: property, member_id: member.uid })} className="cursor-pointer w-[1.125rem] h-[1.125rem]" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14.4608 13.6644C14.513 13.7166 14.5545 13.7787 14.5828 13.8469C14.6111 13.9152 14.6256 13.9884 14.6256 14.0623C14.6256 14.1362 14.6111 14.2094 14.5828 14.2777C14.5545 14.346 14.513 14.408 14.4608 14.4603C14.4085 14.5126 14.3465 14.554 14.2782 14.5823C14.2099 14.6106 14.1367 14.6251 14.0628 14.6251C13.9889 14.6251 13.9157 14.6106 13.8474 14.5823C13.7792 14.554 13.7171 14.5126 13.6648 14.4603L9.00031 9.79506L4.33578 14.4603C4.23023 14.5658 4.08708 14.6251 3.93781 14.6251C3.78855 14.6251 3.64539 14.5658 3.53984 14.4603C3.4343 14.3547 3.375 14.2116 3.375 14.0623C3.375 13.9131 3.4343 13.7699 3.53984 13.6644L8.20508 8.99983L3.53984 4.33529C3.4343 4.22975 3.375 4.08659 3.375 3.93732C3.375 3.78806 3.4343 3.6449 3.53984 3.53936C3.64539 3.43381 3.78855 3.37451 3.93781 3.37451C4.08708 3.37451 4.23023 3.43381 4.33578 3.53936L9.00031 8.20459L13.6648 3.53936C13.7704 3.43381 13.9135 3.37451 14.0628 3.37451C14.2121 3.37451 14.3552 3.43381 14.4608 3.53936C14.5663 3.6449 14.6256 3.78806 14.6256 3.93732C14.6256 4.08659 14.5663 4.22975 14.4608 4.33529L9.79555 8.99983L14.4608 13.6644Z" fill="#FF4242" />
            </svg>
          </div>
        ))}
      </div>
      <button disabled={members.length >= max_members} onClick={() => fetch('INVITE_MEMBER_PROPERTY', property)} className="bg-white/[0.01] rounded-[5px] text-white/45 text-sm h-[2.625rem] hover:!bg-gradient-to-r hover:from-primary-500 hover:to-primary-600 hover:text-white disabled:pointer-events-none disabled:opacity-50">Adicionar novo membro de confian√ßa</button>
    </div>
  )
}